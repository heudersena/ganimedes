"use strict";var y=Object.create;var s=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var _=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var b=(r,e)=>{for(var t in e)s(r,t,{get:e[t],enumerable:!0})},f=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of p(e))!x.call(r,i)&&i!==t&&s(r,i,{get:()=>e[i],enumerable:!(n=E(e,i))||n.enumerable});return r};var w=(r,e,t)=>(t=r!=null?y(_(r)):{},f(e||!r||!r.__esModule?s(t,"default",{value:r,enumerable:!0}):t,r)),A=r=>f(s({},"__esModule",{value:!0}),r);var M={};b(M,{ProfileDatabase:()=>d});module.exports=A(M);var h=require("@prisma/client"),o=new h.PrismaClient({});o.$disconnect();var a=(r,e=!1,t="")=>({data:r,error:e,errorMessage:t});var u=w(require("gerar-cpf")),m=()=>"G-"+(0,u.default)();var c=class{static async DatabaseMethodCreation(e){try{let t=await o.accumulator_bonus.create({data:{bonus_amount:0,profile_id:e}});return a(t)}catch(t){return a([],!0,t)}}};var d=class{static async DatabaseMethodSelectAll(){try{let e=await o.profile.findMany();return a(e)}catch(e){return a([],!0,e)}}static async DatabaseMethodGetTotalBalance(e){try{let t=await o.profile.findFirst({where:{keycloak_id:e},select:{balance:!0,bonus:!0}});return a(t)}catch(t){return a([],!0,t)}}static async DatabaseMethodSelectOne(e){try{let t=await o.profile.findFirst({where:{keycloak_id:e},orderBy:{created_at:"desc"}});return a(t)}catch(t){return a([],!0,t)}}static async DatabaseMethodCreation(e){try{if(console.log("0000000000000000000000000000000000"),console.log(await this.DatabaseMethodAuxiliariesCheckExistsCPF(e.cpf)),console.log(await this.DatabaseMethodAuxiliariesCheckExistsEMAIL(e.email)),console.log("0000000000000000000000000000000000"),await this.DatabaseMethodAuxiliariesCheckExistsCPF(e.cpf)||await this.DatabaseMethodAuxiliariesCheckExistsEMAIL(e.email))return a([],!0,"EMAIL OU CPF J\xC1 EXISTE EM NOSSOS CADASTRO!");let t=await o.profile.create({data:{keycloak_id:e.keycloak_id,first_name:e.first_name,second_name:e.second_name,email:e.email,cpf:e.cpf??m(),balance:e.balance??0,bonus:e.bonus??0,phone:e.phone,type_profile:"ROLE_PLAYER",keyPix:e.keyPix,reference_code:e.reference_code??"NULL"}}),n=await c.DatabaseMethodCreation(t.id);return a({content:t,accumulator_create:n})}catch(t){return a([],!0,t)}}static async DatabaseMethodEditAdmin(e,t,n){try{let i=await o.profile.update({where:{id:e},data:{type_profile:t.roles,reference_code:n}});return a(i)}catch(i){return a([],!0,i)}}static async DatabaseMethodEditUser(e,t,n,i){try{let l=await o.profile.update({where:{keycloak_id:e},data:{phone:t,cpf:n,keyPix:i}});return a(l)}catch(l){return l}}static async DatabaseMethodAuxiliariesCheckExistsCPF(e){return e===void 0?!1:!!await o.profile.findFirst({where:{cpf:e}})}static async DatabaseMethodAuxiliariesCheckExistsEMAIL(e){return!!await o.profile.findFirst({where:{email:e}})}};0&&(module.exports={ProfileDatabase});
